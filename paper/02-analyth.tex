
\chapter{Аналитический раздел}

В данном разделе будут представлены обзор предметной области, существующих методов определения позы человека, а также проведен сравнительный анализ этих методов.

\section{Обзор предметной области}

\subsection{Классические подходы к определению позы человека}

Глубокое обучение --- тип машинного обучения \cite{vyugin}, в котором используются искусственные нейронные сети с несколькими слоями для обработки сложных данных, которые активно используются в настоящее время в определении позы человека. Однако до его внедрения использовались другие методы, а именно: 
\begin{enumerate}[label=\arabic*)]
 	\item Модель пиктографических структур \cite{polygraphic}:
 	
 		Эта структура моделирует пространственные взаимосвязи частей твердого тела, выражая их в виде древовидной графической модели, чтобы предсказать местоположение суставов тела. 
 		Эти пространственные связи показаны с помощью пружин, и части представляют собой шаблоны внешнего вида, основанные на изображении. 
 		Путем параметризации частей с помощью расположения и ориентации пикселей, полученная структура может моделировать артикуляции. 
 		
 		На рисунке \ref{img:polygraphic} продемонстрировано наглядное представление этой модели.
 		
 		Проблема этого подхода заключается в том, что он не может уловить корреляции между невидимыми и деформируемыми частями тела, что означает, что модель подвержена ошибкам, если не все конечности человека видны. 
 		Она также не зависит от данных изображения.
 		\begin{figure}[ht!]
 			\centering
 			\includegraphics[width=0.4\linewidth]{assets/poly.png}
 			\caption{Пример пиктографической структуры.}
 			\label{img:polygraphic}
 		\end{figure}
 		

 	\item Гибкое смешение частей \cite{FPE}:
 		
 		\begin{itemize}
 			\item Этот подход использует деформируемые модели частей, которые представляют собой коллекцию шаблонов, которые подбираются по изображению и располагаются в деформируемой конфигурации. 
 			Кроме того, каждая модель имеет глобальные шаблоны и шаблоны деталей. 
 			Основная идея заключается в том, чтобы использовать смесь мелких неориентированных деталей в отличие от использования семейства деформированных, то есть повернутых и ракурсных шаблонов.
 			Причина этого заключается в том, что с различиями в том, как выглядят конечности, и изменениями в точке зрения.
 			
 			\item Гибкое смещение частей одновременно фиксирует пространственные отношения между расположением деталей и отношения совпадения между смесями деталей, что приводит к моделям пиктографического структуры, которые кодируют исключительно пространственные отношения. 
 			Благодаря динамическому программированию, модели разделяют вычисления между аналогичными искривлениями, что делает этот подход не только значительно быстрым, но и высокоэффективным.
 			Кроме того они моделируют экспоненциально большой набор глобальных смесей через композицию смесей локальных частей для того, чтобы изучить понятия локальной жесткости, а также уловить влияние глобальной геометрии на локальный внешний вид, то есть внешний вид деталей различается в разных местах. 
 			На рисунке \ref{img:fpe} демонстрируется визуальное представление этой модели.
 			
 			\begin{figure}[ht!]
 				\centering
 				\includegraphics[width=0.4\linewidth]{assets/fpe.jpeg}
 				\caption{Пример гибкого смещения частей.}
 				\label{img:fpe}
 			\end{figure}
 			
 			\item Гибкое смещение частей способна хорошо выражать сложные отношения между суставами, поэтому она также может моделировать артикуляцию.
 			Однако у нее есть свои проблемы, которые включат ограниченную выразительность и отсутствие учета глобального контекста.
 			
 				
 		\end{itemize}
 		
 		
 	\item Края, цветочные гистограммы, контуры и гистограмма ориентированных градиентов были другими характеристиками, которые применялись в ранних работах определения позы человека и служили основными строительными блоками различных классических моделей для определения точного местоположения частей тела \cite{polygraphic}. 
\end{enumerate}

К общим проблемам классических подходов относятся плохое обобщение и неточное обнаружение частей тела. Поэтому для решения этих проблем было применено глубокое обучение.

\section{Глубокое обучение в сверточных нейронных сетях в машине позирования}

Машина позирования состоит из последовательных мультиклассовых предсказаний, которых обучены предсказывать местоположение каждой детали на каждом уровне иерархии. Она также имеет модуль вычисления характеристик изображения и модуль предсказания, оба из которых могут быть заменены сверточной архитектурой \cite{CNN}, что позволяет позволяет изучать как изображения, так и контекстуальные представления признаков из данных.
Именно эта идея привела к созданию Convolutional Pose Machine (CPM), которая является первой моделью оценки позы человека на основе глубокого обучения \cite{wei2016cpm}.

CPM полностью дифференцируема, что позволяет обучать ее многоступенчатую архитектуру по принципу обратного распространения, алгоритму, используемому для обучения нейронных сетей с прямой передачей 
Кроме того, ее последовательная структура предсказания, состоящая из сверточных сетей и обучается неявным пространственным моделям, использует большие рецепторные поля на картах убеждений, полученных на предыдущих этапах, что помогает в изучении пространственных связей между деталями на большом расстоянии и приводит к повышению точности за счет все более точных оценок местоположения деталей на последующих шагах.

Проблема исчезающих градиентов, когда при обратном распространении ошибки, градиенты уменьшаются по мере прохождения через многие слои решается с помощью промежуточного контроля после каждого этапа \cite{wei2016cpm}.

На первом этапе CPM предсказывает предположения о деталях, используя только локальные данные изображения, с помощью глубокой сверточной сети, состоящей из 7 общих сверточных слоев. Карты убеждений, созданные на этом этапе, добавляются к вводимым данным перед обработкой несколькими сверточными слоями.

На более поздних этапах эффективное восприимчивое поле увеличивается для повышения точности. 
В целом, этот подход позволяет архитектуре изучать как особенности изображения, так и пространственные модели, зависящие от изображения, для задач прогнозирования без необходимости использовать графический стиль моделирования выводы.

На рисунке \ref{img:cpm} показан пример работы CPM.
\begin{figure}[ht!]
	\centering
	\includegraphics[width=1\linewidth]{assets/cpm.png}
	\caption{Пример работы CPM.}
	\label{img:cpm}
\end{figure}

\section{Точность и метрики}

\subsection{Определение точности и понятие метрики}
